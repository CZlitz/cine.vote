<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Security Video Page</title>
  <style>
    body {
      background: white;
      font-family: Arial, sans-serif;
      font-size: 22px;
      padding: 40px;
      margin: 0;
    }

    .placeholder {
      max-width: 900px;
      margin: 0 auto;
      text-align: left;
    }

    #content {
      display: block;
      margin-top: 1500px;
      text-align: center;
    }

    #videoContainer {
      position: relative;
      display: inline-block;
      width: 90%;
      max-width: 1200px;
      margin-top: 30px;
      background: #000;
    }

    video {
      width: 100%;
      display: block;
    }

    #terminated {
      display: none;
      font-size: 28px;
      margin-top: 100px;
      text-align: center;
      color: red;
    }

    #loading {
      display: none;
      margin-top: 100px;
      text-align: center;
    }

    .spinner {
      margin: 0 auto;
      width: 50px;
      height: 50px;
      border: 6px solid #ccc;
      border-top-color: #000;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    strong { color: black; }
    .underline { border-bottom: 2px solid #000; font-weight: bold; }
    .underline-light { border-bottom: 2px solid #000; }

    #uuidDisplay {
      position: fixed;
      bottom: 10px;
      right: 15px;
      font-size: 14px;
      color: rgba(0, 0, 0, 0.3);
      z-index: 9999;
      user-select: none;
      pointer-events: none;
    }

    /* Camada preta com quadrados */
    #blackSquaresOverlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: black;
      z-index: 10000;
      pointer-events: none;
      display: grid;
      grid-template-columns: repeat(20, 1fr);
      grid-template-rows: repeat(12, 1fr);
    }

    #blackSquaresOverlay > div {
      /* Cada quadrado */
      background-color: rgba(0,0,0,0.8);
    }

    #blackSquaresOverlay > div:nth-child(odd) {
      background-color: rgba(0,0,0,0.5);
    }
  </style>
</head>
<body>

<div class="placeholder">
  <h1>Security Log Placeholder</h1>
  <p>Welcome to this exclusive study designed to evaluate teasers and trailers of upcoming media releases. This controlled environment allows us to gather valuable initial impressions, audience reactions, and constructive feedback that are essential for refining the final product before its official launch.</p>
  <p>All content provided within this study is highly confidential and intended solely for authorized participants. Due to the sensitive nature of the materials, strict security measures are in place to prevent any unauthorized distribution. Unauthorized leaks, screenshots, recordings, or any form of sharing outside this platform are strictly prohibited and considered serious violations.</p>
  <p>Such breaches not only compromise the integrity of the study but can also adversely impact marketing strategies, contractual agreements, and overall project success. Therefore, we emphasize the importance of maintaining confidentiality and adhering to all guidelines established for this study.</p>
  <p>Your participation and cooperation are crucial to the success of this evaluation process. By respecting these rules, you help us protect exclusive content and ensure that the final release meets the highest standards of quality and security.</p>
  <p>Thank you for your understanding and for being an integral part of this important process. Together, we strive to deliver exceptional experiences while safeguarding the interests of all stakeholders involved.</p>
</div>

<div id="content">
  <p>
    For security reasons, once the video starts playing  
    <span class="underline">please do not use the keyboard, mouse or click outside of this window.</span><br>
    <span class="underline">Doing so will result in you being terminated from the <strong>study</strong>.</span><br>
    <span class="underline-light">We appreciate your understanding.</span>
  </p>

  <div id="videoContainer">
    <video id="secureVideo" playsinline preload="auto">
      <source src="video.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>
</div>

<div id="terminated">
  <p><strong>SESSION TERMINATED</strong><br />Unauthorized input detected.</p>
</div>

<div id="loading">
  <div class="spinner"></div>
</div>

<div id="uuidDisplay"></div>

<script>
  const video = document.getElementById("secureVideo");
  const content = document.getElementById("content");
  const terminated = document.getElementById("terminated");
  const loading = document.getElementById("loading");
  const videoContainer = document.getElementById("videoContainer");

  // UUID Generator
  function generateUUID() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      let r = Math.random() * 16 | 0;
      let v = c === 'x' ? r : (r & 0x3 | 0x8);
      return v.toString(16);
    });
  }

  // Mostra UUID na tela
  let uuid = sessionStorage.getItem("sessionUUID");
  if (!uuid) {
    uuid = generateUUID();
    sessionStorage.setItem("sessionUUID", uuid);
  }
  document.getElementById("uuidDisplay").textContent = "Session ID: " + uuid;

  // Se o vídeo já foi visto, mostra só loading e limpa o vídeo
  if (sessionStorage.getItem("videoViewed")) {
    content.style.display = "none";
    loading.style.display = "block";
    
    video.pause();
    video.removeAttribute('src');
    video.load();
  } else {
    sessionStorage.setItem("videoViewed", "true");
  }

  let protectionEnabled = false;
  let videoStarted = false;

  document.addEventListener("click", () => {
    if (videoStarted) return;

    const rect = video.getBoundingClientRect();
    const inViewport = rect.top < window.innerHeight && rect.bottom >= 0;

    if (inViewport) {
      video.play().then(() => {
        videoStarted = true;
        setTimeout(() => protectionEnabled = true, 500);
      }).catch(err => {
        console.error("Playback failed:", err);
      });
    }
  });

  function erasePage(e) {
    if (!protectionEnabled) return;
    if (e.target.tagName === "VIDEO" || video.contains(e.target)) return;

    if (!video.paused) video.pause();
    video.src = "";
    video.load();

    content.style.display = "none";
    terminated.style.display = "block";
  }

  ["mousemove", "keydown", "click"].forEach(eventType => {
    document.addEventListener(eventType, erasePage);
  });

  video.addEventListener("ended", () => {
    content.style.display = "none";
    loading.style.display = "block";
  });

  // Função para criar camada preta com quadrados
  function createBlackSquaresOverlay() {
    const overlay = document.createElement('div');
    overlay.id = 'blackSquaresOverlay';

    // 20 colunas x 12 linhas = 240 quadrados
    for (let i = 0; i < 20 * 12; i++) {
      const square = document.createElement('div');
      square.style.backgroundColor = (i % 2 === 0) ? 'rgba(0,0,0,0.8)' : 'rgba(0,0,0,0.5)';
      overlay.appendChild(square);
    }

    return overlay;
  }

  // Mostrar efeito ao detectar print screen
  function showBlackSquaresEffect() {
    // Evita múltiplos overlays
    if (document.getElementById('blackSquaresOverlay')) return;

    const overlay = createBlackSquaresOverlay();
    videoContainer.appendChild(overlay);

    setTimeout(() => {
      overlay.remove();
    }, 5000);
  }

  // Detecta print screen ou Ctrl+Shift+S
  document.addEventListener('keydown', (e) => {
    if (
      e.key === 'PrintScreen' ||
      (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 's')
    ) {
      showBlackSquaresEffect();
    }
  });

</script>

</body>
</html>
